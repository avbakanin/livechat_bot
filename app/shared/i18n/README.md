# –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è (i18n) –¥–ª—è Telegram –±–æ—Ç–∞

–°–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —è–∑—ã–∫–æ–≤ –≤ –±–æ—Ç–µ. –í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ä—É—Å—Å–∫–∏–π –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫–∏.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
app/shared/i18n/
‚îú‚îÄ‚îÄ __init__.py              # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å I18nManager
‚îî‚îÄ‚îÄ translations.json         # JSON —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞

Middleware `I18nMiddleware` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Telegram –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —è–∑—ã–∫ –¥–ª—è –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

```python
# –í main.py —É–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω middleware
dp.message.middleware(I18nMiddleware())
dp.callback_query.middleware(I18nMiddleware())
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö

```python
@router.message()
async def handle_message(message: Message, i18n):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∞
    text = i18n.t("commands.start.welcome", free_limit=100)
    await message.answer(text)
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

```python
from shared.i18n import i18n

def get_help_text() -> str:
    return f"""
{hbold(i18n.t('commands.help.title'))}

{hbold(i18n.t('commands.help.commands_title'))}
{i18n.t('commands.help.start_command')}
"""
```

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞—Ö

```python
from shared.i18n import i18n

def get_gender_keyboard() -> InlineKeyboardMarkup:
    return InlineKeyboardMarkup(inline_keyboard=[
        [
            InlineKeyboardButton(
                text=i18n.t("buttons.choose_female"), 
                callback_data="gender_female"
            ),
            InlineKeyboardButton(
                text=i18n.t("buttons.choose_male"), 
                callback_data="gender_male"
            )
        ]
    ])
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

–ü–µ—Ä–µ–≤–æ–¥—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –≤ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:

```json
{
  "ru": {
    "commands": {
      "start": {
        "welcome": "–ü—Ä–∏–≤–µ—Ç! –£ —Ç–µ–±—è {free_limit} –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–µ–Ω—å."
      }
    },
    "buttons": {
      "choose_female": "–í—ã–±—Ä–∞—Ç—å –¥–µ–≤—É—à–∫—É üòä"
    }
  },
  "en": {
    "commands": {
      "start": {
        "welcome": "Hello! You have {free_limit} free messages per day."
      }
    },
    "buttons": {
      "choose_female": "Choose girl üòä"
    }
  }
}
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏

- **ru** - –†—É—Å—Å–∫–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **en** - –ê–Ω–≥–ª–∏–π—Å–∫–∏–π

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Telegram:

- `ru` ‚Üí –†—É—Å—Å–∫–∏–π
- `en` ‚Üí –ê–Ω–≥–ª–∏–π—Å–∫–∏–π  
- `uk`, `be`, `kk` ‚Üí –†—É—Å—Å–∫–∏–π (–±–ª–∏–∂–∞–π—à–∏–π —è–∑—ã–∫)
- –û—Å—Ç–∞–ª—å–Ω—ã–µ ‚Üí –†—É—Å—Å–∫–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `app/shared/i18n/translations.json`
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á –≤ –Ω—É–∂–Ω—É—é —Å–µ–∫—Ü–∏—é
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —è–∑—ã–∫–æ–≤

–ü—Ä–∏–º–µ—Ä:
```json
{
  "ru": {
    "new_section": {
      "new_key": "–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º"
    }
  },
  "en": {
    "new_section": {
      "new_key": "New text in English"
    }
  }
}
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–µ–≤–æ–¥–∞—Ö

–ü–µ—Ä–µ–≤–æ–¥—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

```python
# –í JSON
"welcome": "–ü—Ä–∏–≤–µ—Ç! –£ —Ç–µ–±—è {free_limit} –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–µ–Ω—å."

# –í –∫–æ–¥–µ
i18n.t("commands.start.welcome", free_limit=100)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: "–ü—Ä–∏–≤–µ—Ç! –£ —Ç–µ–±—è 100 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–µ–Ω—å."
```

## Fallback –º–µ—Ö–∞–Ω–∏–∑–º

–ï—Å–ª–∏ –ø–µ—Ä–µ–≤–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —è–∑—ã–∫–∞, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–≤–æ–¥ –∏–∑ —è–∑—ã–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Ä—É—Å—Å–∫–∏–π). –ï—Å–ª–∏ –∏ —Ç–∞–º –Ω–µ—Ç –ø–µ—Ä–µ–≤–æ–¥–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–ª—é—á –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö: `[missing.key]`.

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —è–∑—ã–∫–∞

1. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —è–∑—ã–∫ –≤ `translations.json`:
```json
{
  "ru": { ... },
  "en": { ... },
  "de": { ... }  // –ù–æ–≤—ã–π —è–∑—ã–∫
}
```

2. –û–±–Ω–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `get_user_language` –≤ `I18nManager`:
```python
language_mapping = {
    'ru': 'ru',
    'en': 'en',
    'de': 'de',  # –ù–æ–≤—ã–π —è–∑—ã–∫
    'uk': 'ru',
    'be': 'ru',
    'kk': 'ru',
}
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö –∫–æ–º–∞–Ω–¥
```python
@router.message(Command("start"))
async def cmd_start(message: Message, i18n):
    await message.answer(i18n.t("commands.start.welcome", free_limit=100))
```

### –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö callback_query
```python
@router.callback_query(F.data == "gender_female")
async def gender_choice(callback: CallbackQuery, i18n):
    await callback.message.edit_text(i18n.t("gender.changed_to_female"))
```

### –í —Å–µ—Ä–≤–∏—Å–∞—Ö
```python
from shared.i18n import i18n

class MessageService:
    def get_error_message(self, error_type: str) -> str:
        return i18n.t(f"errors.{error_type}")
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∫–ª—é—á–∏**: `commands.start.welcome` –≤–º–µ—Å—Ç–æ `msg1`
2. **–ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏**: –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã –≤ `commands`, –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –≤ `buttons`
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**: –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `{variable}`
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø–µ—Ä–µ–≤–æ–¥—ã**: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∫–ª—é—á–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –≤—Å–µ —è–∑—ã–∫–∏
5. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ**: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É —Å —Ä–∞–∑–Ω—ã–º–∏ —è–∑—ã–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
