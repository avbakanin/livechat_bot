# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "Instance is frozen"

## –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –∏–∑-–∑–∞ –ø–æ–ø—ã—Ç–∫–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç `text` –æ–±—ä–µ–∫—Ç–∞ `Message` –æ—Ç aiogram:

```python
message.text = sanitized_text  # ‚ùå –û–®–ò–ë–ö–ê!
```

**–ü—Ä–∏—á–∏–Ω–∞:** –í aiogram 3.x –æ–±—ä–µ–∫—Ç—ã `Message` —è–≤–ª—è—é—Ç—Å—è **immutable** (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º–∏) Pydantic –º–æ–¥–µ–ª—è–º–∏. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –µ–≥–æ –ø–æ–ª—è –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω—è—Ç—å.

## –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π

**–ë—ã–ª–æ:**
```python
message.text = sanitized_text  # ‚ùå –û—à–∏–±–∫–∞
await message_service.add_message(user_id, "user", message.text)
```

**–°—Ç–∞–ª–æ:**
```python
message_text = sanitized_text  # ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
await message_service.add_message(user_id, "user", message_text)
```

### 2. –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å–ø–∞–º–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–ª–∞ –æ–±—ã—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ —Å–ø–∞–º.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –£–≤–µ–ª–∏—á–µ–Ω—ã –ø–æ—Ä–æ–≥–∏ –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –∫–∞–ø—Å–∞ (—Å 10 –¥–æ 20 —Å–∏–º–≤–æ–ª–æ–≤)
- –£–≤–µ–ª–∏—á–µ–Ω—ã –ø–æ—Ä–æ–≥–∏ –¥–ª—è –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ (—Å 10% –¥–æ 20%)
- –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª–∏–Ω—ã

### 3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–æ—Ä–æ–≥–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- **–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã:** —Å 30% –¥–æ 60% –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- **–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–ª–æ–≤–∞:** —Å 50% –¥–æ 70% –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å 5+ —Å–ª–æ–≤–∞–º–∏
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å–ª–æ–≤–∞:** —Å 2 –¥–æ 3 —Å–∏–º–≤–æ–ª–æ–≤

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–û—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞** - –æ–±—ä–µ–∫—Ç `Message` –±–æ–ª—å—à–µ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è  
‚úÖ **–õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã** - –æ–±—ã—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ —Å—á–∏—Ç–∞—é—Ç—Å—è —Å–ø–∞–º–æ–º  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞** - —Ä–µ–∞–ª—å–Ω—ã–µ —É–≥—Ä–æ–∑—ã –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è  

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢–µ–ø–µ—Ä—å –±–æ—Ç –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å:
- –û–±—ã—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
- –†–µ–∞–ª—å–Ω—ã–π —Å–ø–∞–º –∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞ –±–µ–∑ –æ—à–∏–±–æ–∫
