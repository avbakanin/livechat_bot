# üìä **–î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø –ü–û –ú–ï–¢–†–ò–ö–ê–ú –ò –ú–û–ù–ò–¢–û–†–ò–ù–ì–£**

## üìã **–û–ë–ó–û–† –°–ò–°–¢–ï–ú–´ –ú–ï–¢–†–ò–ö**

LiveChat Bot –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é —Å–∏—Å—Ç–µ–º—É –º–µ—Ç—Ä–∏–∫** —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∞–ª–µ—Ä—Ç–∞–º–∏ –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –±–∏–∑–Ω–µ—Å-–ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.

### üéØ **–ü—Ä–∏–Ω—Ü–∏–ø—ã –º–µ—Ç—Ä–∏–∫**

1. **–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è** - –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ —Ç–∏–ø–∞–º –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é
2. **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫–Ω–∞** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö
4. **–≠–∫—Å–ø–æ—Ä—Ç** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
5. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** - –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö

---

## üèóÔ∏è **–ê–†–•–ò–¢–ï–ö–¢–£–†–ê –°–ò–°–¢–ï–ú–´ –ú–ï–¢–†–ò–ö**

### **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Data Sources  ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Metrics Collector‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Dashboard     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ   Alert System  ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ Export System   ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìä **–ö–ê–¢–ï–ì–û–†–ò–ò –ú–ï–¢–†–ò–ö**

### **1. System Metrics** üñ•Ô∏è
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ |
|---------|-----|----------|--------|
| `system_uptime_seconds` | GAUGE | –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã | –í—Ä–µ–º—è —Å –º–æ–º–µ–Ω—Ç–∞ –∑–∞–ø—É—Å–∫–∞ |
| `system_memory_usage_mb` | GAUGE | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ | –¢–µ–∫—É—â–µ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ RAM |
| `system_cpu_usage_percent` | GAUGE | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU | –ü—Ä–æ—Ü–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ |

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
from shared.metrics.advanced_metrics import metrics_manager

# –ó–∞–ø–∏—Å—å –º–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
metrics_manager.system.record_memory_usage(512.5)  # 512.5 MB

# –ó–∞–ø–∏—Å—å –º–µ—Ç—Ä–∏–∫–∏ CPU
metrics_manager.system.record_cpu_usage(75.2)  # 75.2%
```

### **2. Performance Metrics** ‚ö°
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ |
|---------|-----|----------|--------|
| `response_time_message_ms` | TIMER | –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ | –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| `response_time_command_ms` | TIMER | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã | –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥ |
| `database_query_time_ms` | TIMER | –í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ë–î |
| `cache_hit` | COUNTER | –ü–æ–ø–∞–¥–∞–Ω–∏—è –≤ –∫—ç—à | –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è |

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
# –ó–∞–ø–∏—Å—å –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
metrics_manager.performance.record_response_time("message", 150.5)  # 150.5ms

# –ó–∞–ø–∏—Å—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫—ç—à–∞
metrics_manager.performance.record_cache_performance("user_cache", hit=True)
```

### **3. Business Metrics** üí∞
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ë–∏–∑–Ω–µ—Å-–ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ KPI

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ |
|---------|-----|----------|--------|
| `user_registration` | COUNTER | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –°—á–µ—Ç—á–∏–∫ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `subscription_change` | COUNTER | –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–æ–∫ | –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É –ø–ª–∞–Ω–∞–º–∏ |
| `revenue` | COUNTER | –î–æ—Ö–æ–¥—ã | –ù–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ |
| `user_engagement_score` | GAUGE | –í–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –û—Ü–µ–Ω–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ |

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
# –ó–∞–ø–∏—Å—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
metrics_manager.business.record_user_registration(12345, source="telegram")

# –ó–∞–ø–∏—Å—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
metrics_manager.business.record_subscription_change(12345, "free", "premium")

# –ó–∞–ø–∏—Å—å –¥–æ—Ö–æ–¥–∞
metrics_manager.business.record_revenue(299.0, currency="RUB", source="subscription")
```

### **4. User Metrics** üë•
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ |
|---------|-----|----------|--------|
| `user_activity` | COUNTER | –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –°—á–µ—Ç—á–∏–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π |
| `session_duration_minutes` | TIMER | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Å—Å–∏–π | –í—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ |
| `user_satisfaction_score` | GAUGE | –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å | –û—Ü–µ–Ω–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
# –ó–∞–ø–∏—Å—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
metrics_manager.user.record_user_activity(12345, "message_sent")

# –ó–∞–ø–∏—Å—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏
metrics_manager.user.record_session_duration(12345, 15.5)  # 15.5 –º–∏–Ω—É—Ç

# –ó–∞–ø–∏—Å—å –æ—Ü–µ–Ω–∫–∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
metrics_manager.user.record_user_satisfaction(12345, 4)  # 4 –∏–∑ 5
```

### **5. Security Metrics** üîí
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ |
|---------|-----|----------|--------|
| `security_event` | COUNTER | –°–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | –°—á–µ—Ç—á–∏–∫ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ |
| `attack_blocked` | COUNTER | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ç–∞–∫–∏ | –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–Ω—ã–µ —É–≥—Ä–æ–∑—ã |
| `user_blocked` | COUNTER | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ –Ω–∞—Ä—É—à–µ–Ω–∏—è–º |

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
# –ó–∞–ø–∏—Å—å —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
metrics_manager.security.record_security_event("sql_injection", "high", user_id=12345)

# –ó–∞–ø–∏—Å—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞—Ç–∞–∫–∏
metrics_manager.security.record_attack_blocked("xss", user_id=12345)

# –ó–∞–ø–∏—Å—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
metrics_manager.security.record_user_blocked(12345, "spam", 24)  # 24 —á–∞—Å–∞
```

### **6. Quality Metrics** üìà
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ |
|---------|-----|----------|--------|
| `response_quality_score` | GAUGE | –ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤ | –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ AI |
| `user_feedback` | GAUGE | –û—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å |

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
# –ó–∞–ø–∏—Å—å –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–∞
metrics_manager.quality.record_response_quality("resp_123", 4.2)  # 4.2 –∏–∑ 5

# –ó–∞–ø–∏—Å—å –æ—Ç–∑—ã–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
metrics_manager.quality.record_user_feedback(12345, "rating", 5)  # 5 –∑–≤–µ–∑–¥
```

### **7. Error Metrics** ‚ùå
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ |
|---------|-----|----------|--------|
| `error_occurred` | COUNTER | –í–æ–∑–Ω–∏–∫—à–∏–µ –æ—à–∏–±–∫–∏ | –°—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ |
| `error_rate_percent` | GAUGE | –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫ | –ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ |

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
# –ó–∞–ø–∏—Å—å –æ—à–∏–±–∫–∏
metrics_manager.error.record_error("database", "connection_timeout", "db_service")

# –ó–∞–ø–∏—Å—å –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –æ—à–∏–±–æ–∫
metrics_manager.error.record_error_rate("api", 2.5)  # 2.5%
```

---

## ‚è∞ **–í–†–ï–ú–ï–ù–ù–´–ï –û–ö–ù–ê**

### **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã:**

| –û–∫–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|------|----------|---------------|
| `MINUTE` | –ú–∏–Ω—É—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ | Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ |
| `HOUR` | –ß–∞—Å–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ | –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ |
| `DAY` | –î–Ω–µ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ | –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å |
| `WEEK` | –ù–µ–¥–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ | –¢—Ä–µ–Ω–¥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ |
| `MONTH` | –ú–µ—Å—è—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ | –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ |

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
from shared.metrics.advanced_metrics import TimeWindow

# –ó–∞–ø–∏—Å—å –º–µ—Ç—Ä–∏–∫–∏ —Å —á–∞—Å–æ–≤—ã–º –æ–∫–Ω–æ–º
metrics_manager.collector.record_metric(
    name="hourly_requests",
    value=150,
    category=MetricCategory.PERFORMANCE,
    time_window=TimeWindow.HOUR
)
```

---

## üö® **–°–ò–°–¢–ï–ú–ê –ê–õ–ï–†–¢–û–í**

### **–£—Ä–æ–≤–Ω–∏ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏:**

| –£—Ä–æ–≤–µ–Ω—å | –û–ø–∏—Å–∞–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏—è |
|---------|----------|----------|
| `LOW` | –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `MEDIUM` | –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |
| `HIGH` | –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è |
| `CRITICAL` | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ |

### **–ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:**

```python
from shared.metrics.alerts import AlertRule, AlertSeverity

# –í—ã—Å–æ–∫–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
AlertRule(
    name="high_response_time",
    metric_name="response_time_message_ms",
    condition=">",
    threshold=5000.0,  # 5 —Å–µ–∫—É–Ω–¥
    severity=AlertSeverity.HIGH,
    description="Response time is too high"
)

# –ù–∏–∑–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ø–∞–¥–∞–Ω–∏–π –≤ –∫—ç—à
AlertRule(
    name="low_cache_hit_rate",
    metric_name="cache_hit_rate_percent",
    condition="<",
    threshold=70.0,  # 70%
    severity=AlertSeverity.MEDIUM,
    description="Cache hit rate is too low"
)

# –í—ã—Å–æ–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫
AlertRule(
    name="high_error_rate",
    metric_name="error_rate_percent",
    condition=">",
    threshold=5.0,  # 5%
    severity=AlertSeverity.CRITICAL,
    description="Error rate is too high"
)
```

### **–ö–∞–Ω–∞–ª—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**

```python
from shared.metrics.alerts import alert_manager, NotificationChannels

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
alert_manager.add_notification_channel(NotificationChannels.console_notification)
alert_manager.add_notification_channel(NotificationChannels.log_notification)
alert_manager.add_notification_channel(NotificationChannels.file_notification)

# Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
alert_manager.add_notification_channel(
    lambda alert: NotificationChannels.webhook_notification(alert, "https://hooks.slack.com/...")
)
```

---

## üìä **–î–ê–®–ë–û–†–î–´**

### **HTML Dashboard:**
```python
from shared.metrics.dashboard import metrics_dashboard

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML –¥–∞—à–±–æ—Ä–¥–∞
html_dashboard = metrics_dashboard.generate_html_dashboard(hours=24)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª
with open("dashboard.html", "w", encoding="utf-8") as f:
    f.write(html_dashboard)
```

### **JSON API:**
```python
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JSON API
json_data = metrics_dashboard.generate_json_api(hours=24)
```

### **Prometheus –º–µ—Ç—Ä–∏–∫–∏:**
```python
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prometheus —Ñ–æ—Ä–º–∞—Ç–∞
prometheus_metrics = metrics_dashboard.generate_prometheus_metrics()
```

---

## üì§ **–≠–ö–°–ü–û–†–¢ –ú–ï–¢–†–ò–ö**

### **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:**

| –§–æ—Ä–º–∞—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|--------|----------|---------------|
| `JSON` | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π JSON | API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ |
| `CSV` | –¢–∞–±–ª–∏—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç | Excel –∞–Ω–∞–ª–∏–∑ |
| `XML` | XML —Ñ–æ—Ä–º–∞—Ç | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã |
| `Prometheus` | Prometheus —Ñ–æ—Ä–º–∞—Ç | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ |
| `InfluxDB` | InfluxDB —Ñ–æ—Ä–º–∞—Ç | –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã |
| `Grafana` | Grafana JSON | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è |
| `Datadog` | Datadog —Ñ–æ—Ä–º–∞—Ç | APM |
| `New Relic` | New Relic —Ñ–æ—Ä–º–∞—Ç | APM |
| `Splunk` | Splunk —Ñ–æ—Ä–º–∞—Ç | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `Elasticsearch` | Elasticsearch —Ñ–æ—Ä–º–∞—Ç | –ü–æ–∏—Å–∫ |

### **–ü—Ä–∏–º–µ—Ä—ã —ç–∫—Å–ø–æ—Ä—Ç–∞:**

```python
from shared.metrics.export import metrics_exporter

# –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON
json_data = metrics_exporter.export("json", hours=24, filename="metrics.json")

# –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
csv_data = metrics_exporter.export("csv", hours=24, filename="metrics.csv")

# –≠–∫—Å–ø–æ—Ä—Ç –≤ Prometheus
prometheus_data = metrics_exporter.export("prometheus", hours=1)

# –≠–∫—Å–ø–æ—Ä—Ç –≤ Grafana
grafana_data = metrics_exporter.export("grafana", hours=24)

# –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
custom_data = metrics_exporter.export(
    "custom", 
    hours=24,
    format_template="Metric: {category}.{metric} = {value} (avg: {avg})"
)
```

---

## üîß **–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° –°–£–©–ï–°–¢–í–£–Æ–©–ï–ô –°–ò–°–¢–ï–ú–û–ô**

### **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:**

```python
# app/domain/message/handlers.py
from shared.metrics.advanced_metrics import metrics_manager
from shared.metrics.alerts import alert_manager

async def handle_message(message: Message, ...):
    start_time = time.time()
    
    try:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        response = await process_message(message.text)
        
        # –ó–∞–ø–∏—Å—å –º–µ—Ç—Ä–∏–∫
        response_time = (time.time() - start_time) * 1000
        metrics_manager.performance.record_response_time("message", response_time)
        metrics_manager.user.record_user_activity(message.from_user.id, "message_sent")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
        summary = metrics_manager.get_comprehensive_summary(1)
        await alert_manager.check_metrics(summary)
        
    except Exception as e:
        # –ó–∞–ø–∏—Å—å –æ—à–∏–±–∫–∏
        metrics_manager.error.record_error("message_processing", str(e), "message_handler")
        raise
```

### **Middleware –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç—Ä–∏–∫:**

```python
# app/core/middleware.py
from shared.metrics.advanced_metrics import metrics_manager

class MetricsMiddleware:
    def __init__(self):
        self.name = "metrics"
        
    async def __call__(self, handler, event, data):
        start_time = time.time()
        
        try:
            result = await handler(event, data)
            
            # –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            response_time = (time.time() - start_time) * 1000
            metrics_manager.performance.record_response_time("handler", response_time)
            
            return result
            
        except Exception as e:
            # –ó–∞–ø–∏—Å—å –æ—à–∏–±–∫–∏
            metrics_manager.error.record_error("handler", str(e), "middleware")
            raise
```

---

## üìà **–ê–ù–ê–õ–ò–ó –ò –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**

### **–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (KPI):**

| KPI | –û–ø–∏—Å–∞–Ω–∏–µ | –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ |
|-----|----------|------------------|
| **Response Time** | –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ | < 2 —Å–µ–∫—É–Ω–¥—ã |
| **Error Rate** | –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫ | < 1% |
| **Cache Hit Rate** | –ü–æ–ø–∞–¥–∞–Ω–∏—è –≤ –∫—ç—à | > 80% |
| **User Satisfaction** | –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å | > 4.0/5 |
| **Uptime** | –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã | > 99.9% |
| **Security Score** | –ë–∞–ª–ª –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | > 90/100 |

### **–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–æ–¥–∫–∏ –º–µ—Ç—Ä–∏–∫
summary = metrics_manager.get_comprehensive_summary(hours=24)

# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
response_time = summary['performance']['response_time_message_ms']['avg']
if response_time > 2000:  # 2 —Å–µ–∫—É–Ω–¥—ã
    print("‚ö†Ô∏è High response time detected")

# –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫
error_rate = summary['error']['error_rate_percent']['latest']
if error_rate > 1.0:  # 1%
    print("üö® High error rate detected")

# –ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
security_events = summary['security']['security_event']['sum']
if security_events > 10:
    print("üîí Multiple security events detected")
```

---

## üöÄ **–ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ –ò –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–ï**

### **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**

1. **–ë–∞—Ç—á–µ–≤–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∑–∞–ø–∏—Å–∏
2. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–µ—Ç—Ä–∏–∫
4. **–°–∂–∞—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
5. **–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**

```python
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∞–º–æ–π —Å–∏—Å—Ç–µ–º—ã –º–µ—Ç—Ä–∏–∫
metrics_manager.system.record_memory_usage(get_memory_usage())
metrics_manager.system.record_cpu_usage(get_cpu_usage())

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø–∏—Å–∏ –º–µ—Ç—Ä–∏–∫
start_time = time.time()
for i in range(1000):
    metrics_manager.performance.record_response_time("test", 100.0)
write_time = (time.time() - start_time) * 1000

print(f"1000 metrics written in {write_time:.2f}ms")
```

---

## ‚úÖ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï**

–°–∏—Å—Ç–µ–º–∞ –º–µ—Ç—Ä–∏–∫ LiveChat Bot –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- **üìä –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- **üö® –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã** - —Ä–∞–Ω–Ω–µ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- **üìà –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** - –ø–æ–Ω—è—Ç–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã
- **üì§ –≠–∫—Å–ø–æ—Ä—Ç** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- **‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞
- **üîß –ì–∏–±–∫–æ—Å—Ç—å** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ —Ñ–æ—Ä–º–∞—Ç—ã

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –≤–∏–¥–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞!** üöÄ
