# ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–∏–≥—Ä–∞—Ü–∏–π

## üóëÔ∏è **–£–¥–∞–ª–µ–Ω–æ:**

### **–û—Ç–¥–µ–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤:**
- ‚ùå `app/migrations/001_add_daily_counters.sql` - —É–¥–∞–ª–µ–Ω
- ‚ùå –ü–∞–ø–∫–∞ `app/migrations/` - —É–¥–∞–ª–µ–Ω–∞

## ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π DDL:**

### **–í—Å–µ –æ–±—ä–µ–∫—Ç—ã —Å—á–µ—Ç—á–∏–∫–æ–≤ –≤ `app/ddl.sql`:**
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `user_daily_counters`
- ‚úÖ –ò–Ω–¥–µ–∫—Å `idx_user_daily_counters_date`
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `increment_user_daily_count()`
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `get_user_daily_count()`
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `reset_daily_counters_for_date()`
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `cleanup_old_counters()`

## üéØ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**

### ‚úÖ **–£–ø—Ä–æ—â–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
- –û–¥–∏–Ω —Ñ–∞–π–ª DDL –≤–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π
- –í—Å–µ –æ–±—ä–µ–∫—Ç—ã –ë–î –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –ü—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å

### ‚úÖ **–£–¥–æ–±—Å—Ç–≤–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:**
- –û–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –º–∏–≥—Ä–∞—Ü–∏–π
- –ü—Ä–æ—Å—Ç–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î

### ‚úÖ **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:**
- –í—Å–µ –æ–±—ä–µ–∫—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ
- –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∏—Å—Ç–∏–Ω—ã –¥–ª—è —Å—Ö–µ–º—ã –ë–î

## üìã **–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
app/
‚îú‚îÄ‚îÄ ddl.sql                    # ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–∞–π–ª —Å–æ –≤—Å–µ–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ users table
‚îÇ   ‚îú‚îÄ‚îÄ messages table (partitioned)
‚îÇ   ‚îú‚îÄ‚îÄ payments table
‚îÇ   ‚îú‚îÄ‚îÄ user_daily_counters table  # ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ
‚îÇ   ‚îú‚îÄ‚îÄ All functions and indexes  # ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ
‚îÇ   ‚îî‚îÄ‚îÄ Partition management
‚îî‚îÄ‚îÄ (no migrations folder)     # ‚úÖ –£–ø—Ä–æ—â–µ–Ω–æ
```

## üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —É–ø—Ä–æ—â–µ–Ω–∞!** –í—Å–µ –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –µ–¥–∏–Ω–æ–º —Ñ–∞–π–ª–µ `ddl.sql`, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–º –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏.
