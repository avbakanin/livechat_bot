# shared/helpers/helpers.py or shared/helpers/stoplist.py 

stoplist = [
    # Суицид и самоповреждение
    "суицид", "самоубийство", "повеситься", "перерезать", "overdose", "OD", "суициднуть",
    "повешение", "броситься", "спрыгнуть", "резать", "порезы",
    
    # Насилие и преступления
    "убить", "киллер", "заказать", "убийство", "избить", "пытки", "похитить",
    "насилие", "убийца", "заказное", "избиение", "истязание", "похищение",
    "терроризм", "теракт", "захват", "заложники",
    
    # Наркотики и вещества
    "наркотики", "героин", "кокаин", "мефедрон", "соли", "травка", "план", "гашиш", 
    "амфетамин", "LSD", "метадон", "экстази", "MDMA", "спайс", "синтетика",
    "доза", "наркоман", "приход", "ломка", "ширяться", "колоться",
    
    # Сексуальные преступления
    "изнасилование", "педофилия", "инцест", "порно", "насиловать",
    "педофил", "детское", "несовершеннолетние", "извращение",
    
    # Оружие и взрывчатые вещества
    "взрывчатка", "бомба", "ТАТУ", "С4", "граната", "взрыв", "подрыв",
    "оружие", "ствол", "травмат", "обрез", "пистолет", "автомат", "огнестрел",
    "пуля", "патроны", "взрывать",
    
    # Киберпреступления
    "взломать", "хакнуть", "DDoS", "фишинг", "кардинг", "вирус", "троян",
    "вымогательство", "шифровальщик", "утечка", "база", "данных", "пароли",
    
    # Мошенничество и коррупция
    "мошенничество", "взятка", "коррупция", "откат", "подкуп", "обман",
    "афера", "развод", "лохотрон",
    
    # Экстремизм и ненависть
    "ненависть", "экстремизм", "расизм", "нацизм", "фашизм", "ксенофобия",
    "геноцид", "резня", "погром", "травля", "буллинг",
    
    # Опасные действия и призывы
    "поджечь", "поджог", "отравить", "яд", "токсично", "химикаты",
    "изувечить", "калечить", "увечье", "инвалидность",
    
    # Нелегальная деятельность
    "контрабанда", "нелегал", "черный", "рынок", "теневой", "бизнес",
    "отмывание", "денег", "рэкет", "крышевание",
    
    # Социально опасный контент
    "секта", "вербовка", "пропаганда", "призыв", "против", "правительства",
    "бунт", "мятеж", "революция", "свержение"
]

import re
def contains_stopwords(text):
    """Проверяет текст на наличие запрещенных слов с любыми окончаниями"""
    text_lower = text.lower()
    
    for stop_word in stoplist:
        # Ищем слово с любыми символами после него (пробелами, знаками препинания и т.д.)
        if re.search(r'\b' + re.escape(stop_word) + r'\w*\b', text_lower):
            return True
    return False

# Более быстрый вариант с предкомпилированными regex
stop_patterns = [re.compile(r'\b' + re.escape(word) + r'\w*\b', re.IGNORECASE) for word in stoplist]

def contains_stopwords_fast(text):
    """Быстрая проверка с предкомпилированными шаблонами"""
    return any(pattern.search(text) for pattern in stop_patterns)
